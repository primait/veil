name: Continous Deployment

on:
  release:
    types: [published]

env:
  CARGO_TERM_COLOR: always

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: install cargo-release
        uses: baptiste0928/cargo-install@48c92f3d491efa23daace9891498a14c5aaa1afd
        with:
          crate: cargo-release
          version: "0.23"
      - name: login 
        run: cargo login "$CARGO_AUTH_KEY"
        env:
          CARGO_AUTH_KEY: ${{ secrets.CARGO_AUTH_KEY }}
      - name: publish
        run: cargo release publish --no-confirm --allow-branch "*" --workspace --all-features --execute
